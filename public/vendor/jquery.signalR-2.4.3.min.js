/*!
 * ASP.NET SignalR JavaScript Library v2.4.3
 * http://github.com/SignalR/SignalR
 *
 * Copyright (c) .NET Foundation. All rights reserved.
 * Licensed under the Apache 2.0
 *
 */
(function(n,t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof module&&module.exports?(module.exports=t(require("jquery")),module.exports.signalR=n.signalR):t(n.jQuery)})("undefined"!=typeof window?window:this,function(n){function t(n){return function(){for(var t=0;t<arguments.length;t++)if(!arguments[t])throw new Error("SignalR: " + n + " must not be null or undefined.");}}function i(n,t){var i;if(!n)throw new Error(t+" is required.");return i=n.match(/\{[0-9]\}/g),i&&i.length>1?i:(i?(i=i[0].slice(1,i[0].length-1))&&(parseInt(i,10)!==t&&(n=n.replace(i,t))):n=n+" "+t),n}function r(n,t){var i;if(!n)throw new Error(t+" is required.");return i=n.match(/\{[0-9]\}/g),i?(i=i[0].slice(1,i[0].length-1))&&(parseInt(i,10)!==t&&(n=n.replace(i,t))):n=n+" "+t,n}var u,e={onStart:"onStart",onStarting:"onStarting",onReceived:"onReceived",onError:"onError",onConnectionSlow:"onConnectionSlow",onReconnecting:"onReconnecting",onReconnect:"onReconnect",onStateChanged:"onStateChanged",onDisconnect:"onDisconnect"},o={connecting:0,connected:1,reconnecting:2,disconnected:4},s={keepAliveWarnAt:2/3,transportConnectTimeout:10,disconnectTimeout:30},f={foreverFrame:{count:0}},h=function(n,t){return!n&&!t||n&&n.substr(0,t.length)===t},c=function(){var i=n.SignalR;if(n.SignalR=n.signalR,n.signalR.fn=n.fn.signalR,u=n.SignalR,n&&(n.connection=n.hubConnection=n.signalR),u)for(var r in e)u[r]&&(n[r]=u[r]);return n};n.signalR=function(t,i,r){return new n.signalR.fn.init(t,i,r)},n.signalR.fn=n.signalR.prototype={init:function(t,i,u){var e,s=this;if(this.url=t,this.qs=i,this._={events:{},handlers:{},state:o.disconnected,errors:[]},this.startingDeferred=n.Deferred(),this.startDeferred=null,this.connectionId=null,this.connectionToken=null,this.transportConnectTimeout=s.sF=n.signalR._.transportConnectTimeout,this.disconnectTimeout=s.dd=null,this._.connectingTimeout=null,this._.reconnectTimeout=null,this._.keepAliveTimeout=null,this.keepAliveData={activated:!1,timeoutHandle:null,beatInterval:1e3,originalKeepAliveTimeout:null,originalDisconnectTimeout:null},this.reconnectWindow=null,this.transport=null,this.lastError=null,this.closing=!1,this.reconnectDelay=2*this.transportConnectTimeout,this.keepAliveWarnAt=n.signalR._.keepAliveWarnAt,this.jsonp=n.ajaxSettings&&"jsonp"===n.ajaxSettings.dataType,this.logging=!1,this._deferral=n.Deferred(function(n){s._deferral=n}),this._deferral.resolve(),this._.initialize=function(){if(s.client={},s.state=o.disconnected,s._.onFallback=null,s._.onDisconnect=n.noop,!u||t)u=s.signalR||(s.signalR={}),s._.onFallback=function(){u&&(n.connection=n.hubConnection=u),u=null},s._.onDisconnect=function(){s.state===o.disconnected&&(s._.onFallback&&(s._.onFallback(),s._.onFallback=null),s._.onDisconnect=n.noop)},s._.onFallback&&(n.connection=n.hubConnection=s,s._.onFallback=null)},e=n.connection?"connection":"hubConnection",n.connection=n.hubConnection=s,s._.initialize(),u){u.fn&&(n[e]=u.fn[e]);for(var f in u)(f in s)||(s[f]=u[f]);n.extend(s,u)}},_l:function(){this.startDeferred&&(this.startDeferred.reject(i("SignalR: Start must be called before state transitions. Current state: {0}",this.state)),this.stop())},_n:function(n,t){var i=this;return function(){var r=i.state===o.connected;return r&&n.apply(i,arguments),r?{connected:!0,result:!0}:t}},_u:function(n){var t=this;return function(){if(t._l(),n.apply(t,arguments),t.state===o.connected)return{connected:!0,result:!0};throw new Error(i("SignalR: Connection must be started before data can be sent. Current state: {0}",t.state))}},_f:function(n){var t=this;return function(){t._l(),n.apply(t,arguments)}},start:function(i,r){var u=this,s,d,l,v;return i=i||{},i.transport&&(i.transport=n.map(n.makeArray(i.transport),function(t){return t.toLowerCase?"auto"===t.toLowerCase()?"auto":n.signalR.transports[t]:t})),this.logging=i.logging===!0||this.logging===!0,i.jsonp?(this.jsonp=i.jsonp,this.ajaxDataType="jsonp"):(this.jsonp||(this.ajaxDataType="text"),this.jsonp=i.jsonp===!0),this._.ajaxDataType=this.ajaxDataType,this.ajaxDataType=this.ajaxDataType,this.reconnectDelay=i.reconnectDelay||this.reconnectDelay,i.transportConnectTimeout&&(this.transportConnectTimeout=i.transportConnectTimeout),this.disconnectTimeout=i.disconnectTimeout||this.disconnectTimeout,this.keepAliveWarnAt=i.keepAliveWarnAt||this.keepAliveWarnAt,this.callTimeout=i.callTimeout,i.useDefaultPath!==!1&&(this.url+="/signalr"),this._l(),this.startDeferred=n.Deferred(),this._.connectingTimeout&&clearTimeout(this._.connectingTimeout),this.state=o.connecting,this.startingDeferred.resolve(),this._.initialize(),this.url=i.url||this.url,this.qs=i.qs||this.qs,this._.events.trigger(e.onStart),this._.log("Negotiating with '{0}'.",this.url),s={url:this.url,qs:this.qs,streaming:!0,transport:i.transport||"auto",jsonp:this.jsonp,onSuccess:function(i){var r,h;u._.log("Negotiation succeeded."),l=function(){return f.foreverFrame.count>=u._.foreverFrame.number},v=function(){return f.foreverFrame.count===u._.foreverFrame.active},u._.initialize(),u.connectionToken=i.ConnectionToken,u.connectionId=i.ConnectionId,u._.announcedTransport=void 0,u._.token=null,u._.longPollDelay=null,u._.disconnectTimeout=i.DisconnectTimeout?i.DisconnectTimeout*1e3:u.disconnectTimeout,u._.keepAliveTimeout=i.KeepAliveTimeout?i.KeepAliveTimeout*1e3:null,u.transportConnectTimeout=i.TransportConnectTimeout?i.TransportConnectTimeout*1e3:u.transportConnectTimeout,u.reconnectWindow=u._.keepAliveTimeout?u.disconnectTimeout-u._.keepAliveTimeout:u.disconnectTimeout,u._.log("Connection Id: {0}.",u.connectionId),u._.log("Using Url: {0}.",u.url),u._.log("Keep Alive Timeout: {0}.",u._.keepAliveTimeout),u._.log("Disconnect Timeout: {0}.",u.disconnectTimeout),u._.log("Try WebSockets: {0}.",i.TryWebSockets),h={webSockets:!i.TryWebSockets?void 0:i.WebSocketServerUrl||i.Url,serverSentEvents:i.TryServerSentEvents?i.Url:void 0,foreverFrame:!i.TryForeverFrame||i.IsSecure?void 0:i.Url,longPolling:i.Url},u._.transports=n.signalR.transports._order(l,v,i.TryWebSockets),u._.startTransport(i.TransportConnectTimeout?i.TransportConnectTimeout*1e3:null,h),r="Disconnected"===i.ProtocolVersion?"SignalR: Incompatible protocol version.":null,r?(u._.onError(r),(u.transport||{}).stop()):(u._.started=!0,u._.startRequested=!1)},onFailure:function(t){u._.log(i("SignalR: Failed to connect to '{0}'. Error: {1}.",u.url,t)),u._.onError(i("SignalR: Failed to connect to '{0}'. Error: {1}.",u.url,t)),u.startDeferred.reject(t)},onTimedOut:function(){var n=i("SignalR: Timed out trying to connect to {0}.",u.url);u._.log(n),u._.onError(n),u.startDeferred.reject(n)},onAbort:function(n){u._.log(n||"Aborted"),u._.onError(n||"Aborted"),u.startDeferred.reject(n)},onRedirect:function(n,t){u._.log("Negotiation redirected to " + n),u.url=n,u.accessToken=t,u._.onFallback=function(){u.accessToken&&(u.accessToken=null)},u.start(i,r)},accessToken:this.accessToken},this._.deferral.state()==="rejected"?this.startDeferred.reject(i("Connection is in an invalid state, likely because the url property was set after call to start.",this.state)):this._.deferral.done(function(){u.transport||(u._.log("Negotiating with '{0}'.",u.url),u._negotiate(s))}),this.startDeferred.promise()},starting:function(n){return t(n,"starting"),this._onStarting(n),this},received:function(n){return t(n,"received"),this._.events.bind(e.onReceived,n),this},error:function(n){return t(n,"error"),this._.onError(n),this},stateChanged:function(n){return t(n,"stateChanged"),this._.events.bind(e.onStateChanged,n),this},connectionSlow:function(n){return t(n,"connectionSlow"),this._.onConnectionSlow(n),this},reconnecting:function(n){return t(n,"reconnecting"),this._.onReconnecting(n),this},reconnected:function(n){return t(n,"reconnected"),this._.onReconnect(n),this},disconnected:function(n){return t(n,"disconnected"),this._.onDisconnect(n),this},stop:function(t,i){var r=this;return n.type(t)==="function"&&(i=t,t=null),this.closing=!0,this._.log("Stopping connection."),this._.onDisconnect=function(){r._.cleanupTimeouts(),r._.log("Stopping connection.")},this.transport&&(this.transport.stop(this),this.transport=void 0),this._.onDisconnect(),this.state=o.disconnected,this._.events.trigger(e.onDisconnect),this._l(),this.startDeferred&&(this.startDeferred.reject(i("Start must be called before data can be sent. Current state: {0}",this.state)),this.startDeferred=null),this._.onReconnect=n.noop,this._.onDisconnect=n.noop,this._.onFallback=null,this._.initHandler=this._.handlers=null,this},send:function(t){var i,r=this;return this._l(),this.transport?(this._.log("Sending data to '{0}' using {1}.",this.url,this.transport.name),i=this.transport,this.ajaxDataType&&(t=n.toJSON(t)),i.send(this,t)):(i=i("The connection has not been started yet."),this._.log(i),this.trigger(e.onError,[i]),{sent:!1,error:i})},_ {"use strict";